{{#Master Master.html}}

{{#Script}}
<script src="{{#Url SharedContent/SessionOutput.js}}"></script>
<script src="{{#Url SharedContent/ansi_up.js}}"></script>
<script>
    var reader;

    $(function () {
        $('#layoutNavbarContent [data-link="sessions"]').addClass('active');

        var outputUrl = '{{#Url api/session/output-stream}}?id={{&SessionId}}';

        reader = new SessionOutputReader();
        reader.onAppend = onAppend;
        reader.onDone = onDone;
        reader.onError = onError;
        reader.begin(outputUrl);
    });

    function onAppend(text) {
        var text_out = ansi_up.escape_for_html(text);
        text_out = ansi_up.ansi_to_html(text_out);
        //text_out = ansi_up.linkify(text_out);

        $('#SessionOutput').append(text_out);
    }

    function onDone() {
        //
    }

    function onError() {
        //
    }
</script>
{{#EndScript}}

{{#Style}}
<style>
    .layout-content {
        min-height: 100vh;
        background: #111;
    }
    .session-output {
        min-height: 100%;
        white-space: pre-wrap;
        word-wrap: break-word;
        font-family: monospace;
        color: #CCC;
    }
</style>
{{#EndStyle}}

<div class="bg-secondary px-2 py-1">
    <h2 class="text-light my-0">Session Output</h2>
</div>

<div id="SessionOutput" class="session-output px-2 py-1"></div>
